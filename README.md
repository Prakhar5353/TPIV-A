# TPIV-A
**Analysis of turbulent transport in the TCV-X21 diverted L-mode reference case using the Global Braginskii Solver (GBS).**

## Project Overview

This repository contains the post-processing and diagnostic tools developed to analyze high-fidelity 3D turbulence simulations of the **TCV-X21** scenario. The primary aim is to contribute to the development of self-consistent, physics-based turbulence models for the plasma edge by performing a rigorous analysis of the **turbulent kinetic energy distribution** on data generated by the **Global Braginskii Solver (GBS)**.

The analysis focuses on the **Scrape-Off Layer (SOL)** and the **X-point region**, quantifying the mechanisms that drive and damp edge fluctuations. By utilizing a density-weighted (Favre) Reynolds decomposition, this framework isolates the contributions of mean flows and turbulent fluctuations to the total energy density.

**Key Physics Analyzed:**
* **Interchange Instability:** Characterizing the interchange-driven nature of transport on the Low-Field Side (LFS).
* **Drift Wave Dynamics:** Evaluating resistive coupling contributions near the X-point.
* **Energy Distribution:** Verification of conservation laws and quantification of the residual imbalance (dissipation).

## Repository Contents

The core of this repository is the analysis notebook `Energy_Distribution_Analysis.ipynb`, which interfaces with the GBS binary output via the custom `GBSPy` library.

### Notebook Functionality

The main analysis notebook performs the following step-by-step workflow:

* **Data Ingestion & Pre-processing**
    * Loads 3D binary field data ($n, \phi, T_e, p, \dots$) from GBS simulation outputs.
    * Handles grid geometry mapping and normalization to physical units ($c_s, \rho_s$).

* **Favre-Reynolds Decomposition**
    * Implements density-weighted time averaging to separate fields into mean ($\bar{f}$) and fluctuating ($\tilde{f}$) components.
    * **Verification:** Numerically verifies that the total kinetic energy partitions exactly into mean flow energy and turbulent fluctuation energy (ensuring cross-terms vanish).

* **Term Reconstruction**
    * Calculates the spatial distributions of the dominant terms governing the energy distribution:
        * **Interchange Source ($S_{int}$):** Comparisons of vacuum vs. curvature operator formulations.
        * **Drift Wave Source ($S_{DW}$):** Evaluation of resistive electron coupling.
        * **Parallel Flux Divergence:** Transport along magnetic field lines.

* **Geometric Mapping & Visualization**
    * **Poloidal Cuts:** Extracts 1D profiles along specific flux surfaces to analyze the angular distribution of transport (LFS vs. X-point).
    * **Radial Scans:** Generates radial distribution plots at key poloidal locations (Midplane, Peak Drive region, X-point).
    * **2D Contouring:** Visualizes the spatial structure of the instability drive with overlaid analysis paths.

